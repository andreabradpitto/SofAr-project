This repository contains a R\+OS package with tools for computing and applying calibration parameters to I\+MU measurements.\hypertarget{md_Smartphone_compensation_README_autotoc_md7}{}\doxysection{Usage}\label{md_Smartphone_compensation_README_autotoc_md7}
The package contains two nodes. The first computes the accelerometer calibration parameters and saves them to a Y\+A\+ML file, and needs to be run only once. After you have run this node to generate the Y\+A\+ML calibration file, the second node uses that file to apply the calibration to an uncalibrated I\+MU topic to produce a calibrated I\+MU topic.\hypertarget{md_Smartphone_compensation_README_autotoc_md8}{}\doxysection{Nodes}\label{md_Smartphone_compensation_README_autotoc_md8}
\hypertarget{md_Smartphone_compensation_README_autotoc_md9}{}\doxysubsection{do\+\_\+calib}\label{md_Smartphone_compensation_README_autotoc_md9}
Computes the accelerometer calibration parameters. It should be run directly with a rosrun in a terminal rather than from a launch file, since it requires keyboard input. After receiving the first I\+MU message, the node will prompt you to hold the I\+MU in a certain orientation and then press Enter to record measurements. After all 6 orientations are complete, the node will compute the calibration parameters and write them to the specified Y\+A\+ML file.

The underlying algorithm is a least-\/squares calibration approach based on and similar to that described in S\+T\+Microeletronics Application Note \href{http://www.st.com/content/ccc/resource/technical/document/application_note/a0/f0/a0/62/3b/69/47/66/DM00119044.pdf/files/DM00119044.pdf/jcr:content/translations/en.DM00119044.pdf}{\texttt{ A\+N4508}}. Due to the nature of the algorithm, obtaining a good calibration requires fairly accurate positioning of the I\+MU along each of its axes.\hypertarget{md_Smartphone_compensation_README_autotoc_md10}{}\doxysubsubsection{Topics}\label{md_Smartphone_compensation_README_autotoc_md10}
\hypertarget{md_Smartphone_compensation_README_autotoc_md11}{}\doxyparagraph{Subscribed Topics}\label{md_Smartphone_compensation_README_autotoc_md11}

\begin{DoxyItemize}
\item {\ttfamily imu} (sensor\+\_\+msgs/\+Imu) ~\newline
 The raw, uncalibrated I\+MU measurements
\end{DoxyItemize}\hypertarget{md_Smartphone_compensation_README_autotoc_md12}{}\doxysubsubsection{Parameters}\label{md_Smartphone_compensation_README_autotoc_md12}

\begin{DoxyItemize}
\item {\ttfamily $\sim$calib\+\_\+file} (string, default\+: \char`\"{}imu\+\_\+calib.\+yaml\char`\"{}) ~\newline
 The file to which the calibration parameters will be written
\item {\ttfamily $\sim$measurements} (int, default\+: 500) ~\newline
 The number of measurements to collect for each orientation
\item {\ttfamily $\sim$reference\+\_\+acceleration} (double, default\+: 9.\+80665) ~\newline
 The expected acceleration due to gravity
\end{DoxyItemize}\hypertarget{md_Smartphone_compensation_README_autotoc_md13}{}\doxysubsection{apply\+\_\+calib}\label{md_Smartphone_compensation_README_autotoc_md13}
Applies the accelerometer calibration parameters computed by the do\+\_\+calib node. Also optionally (enabled by default) computes the gyro biases at startup and subtracts them off.\hypertarget{md_Smartphone_compensation_README_autotoc_md14}{}\doxysubsubsection{Topics}\label{md_Smartphone_compensation_README_autotoc_md14}
\hypertarget{md_Smartphone_compensation_README_autotoc_md15}{}\doxyparagraph{Subscribed Topics}\label{md_Smartphone_compensation_README_autotoc_md15}

\begin{DoxyItemize}
\item {\ttfamily raw} (sensor\+\_\+msgs/\+Imu) ~\newline
 The raw, uncalibrated I\+MU measurements
\end{DoxyItemize}\hypertarget{md_Smartphone_compensation_README_autotoc_md16}{}\doxyparagraph{Published Topics}\label{md_Smartphone_compensation_README_autotoc_md16}

\begin{DoxyItemize}
\item {\ttfamily corrected} (sensor\+\_\+msgs/\+Imu) ~\newline
 The corrected, calibrated I\+MU measurements
\end{DoxyItemize}\hypertarget{md_Smartphone_compensation_README_autotoc_md17}{}\doxysubsubsection{Parameters}\label{md_Smartphone_compensation_README_autotoc_md17}

\begin{DoxyItemize}
\item {\ttfamily $\sim$calib\+\_\+file} (string, default\+: \char`\"{}imu\+\_\+calib.\+yaml\char`\"{}) ~\newline
 The file from which to read the calibration parameters
\item {\ttfamily $\sim$calibrate\+\_\+gyros} (bool, default\+: true) ~\newline
 Whether to compute gyro biases at startup and subsequently subtract them off
\item {\ttfamily $\sim$gyro\+\_\+calib\+\_\+samples} (int, default\+: 100) ~\newline
 The number of measurements to use for computing the gyro biases 
\end{DoxyItemize}