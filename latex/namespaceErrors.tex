\hypertarget{namespaceErrors}{}\doxysection{Errors Namespace Reference}
\label{namespaceErrors}\index{Errors@{Errors}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{namespaceErrors_a7f71b26e98bdf8ea46cc8a836554915b}{ang\+\_\+mis}} (\mbox{\hyperlink{namespaceErrors_a023b701c62a5148c5404d9551205c56d}{Rg}}, \mbox{\hyperlink{namespaceErrors_aa04a1cb38d02a2489c3216d0888ad17c}{Re}})
\begin{DoxyCompactList}\small\item\em Computes the angular misalignment between goal frame and e.\+e. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}{errors}} (data)
\begin{DoxyCompactList}\small\item\em Computes the errors needed by the inverse kinematics algorithms. \end{DoxyCompactList}\item 
def \mbox{\hyperlink{namespaceErrors_a6c943ecf9e79fec7d2edc67cf759e9af}{errors\+\_\+node}} ()
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespaceErrors_a0d9c70e857a30fb1cd960b97e3e8a229}{pub}} = rospy.\+Publisher(\textquotesingle{}\mbox{\hyperlink{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}{errors}}\textquotesingle{}, Float64\+Multi\+Array, queue\+\_\+size=10)
\item 
\mbox{\hyperlink{namespaceErrors_a023b701c62a5148c5404d9551205c56d}{Rg}} = np.\+zeros((3,3))
\item 
\mbox{\hyperlink{namespaceErrors_aa04a1cb38d02a2489c3216d0888ad17c}{Re}} = np.\+zeros((3,3))
\item 
\mbox{\hyperlink{namespaceErrors_a207e0aed7e68aa47d2e8962d266d79ae}{xg}} = np.\+zeros((3,1))
\item 
\mbox{\hyperlink{namespaceErrors_a69195579482cb38bc0acf33580ce5718}{xe}} = np.\+zeros((3,1))
\item 
\mbox{\hyperlink{namespaceErrors_a15d70e1c6625465d323cab0f7be6c012}{vg}} = np.\+zeros((3,1))
\item 
\mbox{\hyperlink{namespaceErrors_a073280aada8fd1740c55bd2dcbf7a2ca}{ve}} = np.\+zeros((3,1))
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespaceErrors_a7f71b26e98bdf8ea46cc8a836554915b}\label{namespaceErrors_a7f71b26e98bdf8ea46cc8a836554915b}} 
\index{Errors@{Errors}!ang\_mis@{ang\_mis}}
\index{ang\_mis@{ang\_mis}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{ang\_mis()}{ang\_mis()}}
{\footnotesize\ttfamily def Errors.\+ang\+\_\+mis (\begin{DoxyParamCaption}\item[{}]{Rg,  }\item[{}]{Re }\end{DoxyParamCaption})}



Computes the angular misalignment between goal frame and e.\+e. 

frame. 
\begin{DoxyParams}{Parameters}
{\em Rg} & goal orientation matrix. \\
\hline
{\em Re} & end effector orientation matrix. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
rho\+: misalignment vector. 
\end{DoxyReturn}


Definition at line 22 of file Errors.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{22 \textcolor{keyword}{def }\mbox{\hyperlink{namespaceErrors_a7f71b26e98bdf8ea46cc8a836554915b}{ang\_mis}}(Rg, Re):}
\DoxyCodeLine{23     \textcolor{stringliteral}{"{}"{}"{}!}}
\DoxyCodeLine{24 \textcolor{stringliteral}{    Computes the angular misalignment between goal frame and e.e. frame.}}
\DoxyCodeLine{25 \textcolor{stringliteral}{    @param Rg: goal orientation matrix.}}
\DoxyCodeLine{26 \textcolor{stringliteral}{    @param Re: end effector orientation matrix.}}
\DoxyCodeLine{27 \textcolor{stringliteral}{    @return rho: misalignment vector.}}
\DoxyCodeLine{28 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30     i = np.transpose(np.array([[1, 0, 0]]))}
\DoxyCodeLine{31     j = np.transpose(np.array([[0, 1, 0]]))}
\DoxyCodeLine{32     k = np.transpose(np.array([[0, 0, 1]]))}
\DoxyCodeLine{33 }
\DoxyCodeLine{34     skew\_i = np.array([[0, 0, 0],}
\DoxyCodeLine{35                      [0, 0, -\/1],}
\DoxyCodeLine{36                      [0, 1, 0]])}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     skew\_j = np.array([[0, 0, 1],}
\DoxyCodeLine{39                      [0, 0, 0],}
\DoxyCodeLine{40                      [-\/1, 0, 0]])}
\DoxyCodeLine{41 }
\DoxyCodeLine{42     skew\_k = np.array([[0, -\/1, 0],}
\DoxyCodeLine{43                      [1, 0, 0],}
\DoxyCodeLine{44                      [0, 0, 0]])}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{comment}{\# this term equals 1 + 2cos(theta), with theta the misalignement angle}}
\DoxyCodeLine{47     summ = np.dot(np.transpose(np.dot(Re, i)), np.dot(Rg, i)) + np.dot(np.transpose(np.dot(Re, j)), np.dot(Rg, j)) + np.dot(np.transpose(np.dot(Re, k)), np.dot(Rg, k))}
\DoxyCodeLine{48 }
\DoxyCodeLine{49     Re\_ = np.transpose(Re)}
\DoxyCodeLine{50 }
\DoxyCodeLine{51     \textcolor{comment}{\# this term equals 2*v*sin(theta), with v the angular misalignement vector}}
\DoxyCodeLine{52     prod = np.dot(np.dot(Re, np.dot(skew\_i, Re\_)), np.dot(Rg, i)) + np.dot(np.dot(Re, np.dot(skew\_j, Re\_)), np.dot(Rg, j)) + np.dot(np.dot(Re, np.dot(skew\_k, Re\_)), np.dot(Rg, k))}
\DoxyCodeLine{53 }
\DoxyCodeLine{54     delta = (summ -\/ 1)/2 \textcolor{comment}{\# = cos(theta)}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56     \textcolor{keywordflow}{if} np.absolute(delta) < 1:}
\DoxyCodeLine{57         theta = np.arccos(delta)}
\DoxyCodeLine{58         v = prod/(2*np.sin(theta))}
\DoxyCodeLine{59         v = v/(np.linalg.norm(v))}
\DoxyCodeLine{60         rho = theta*v}
\DoxyCodeLine{61     \textcolor{keywordflow}{elif} delta == 1:}
\DoxyCodeLine{62         \textcolor{comment}{\# theta multiple of 2*k*pi}}
\DoxyCodeLine{63         theta = 0}
\DoxyCodeLine{64         rho = np.array([[0, 0, 0]]).transpose()}
\DoxyCodeLine{65     \textcolor{keywordflow}{else}:}
\DoxyCodeLine{66         theta = np.pi}
\DoxyCodeLine{67         summ1 = np.dot(Re, i) + np.dot(Re, j) + np.dot(Re, k) + np.dot(Rg, i) + np.dot(Rg, j) + np.dot(Rg, k)}
\DoxyCodeLine{68         v0 = summ1/(np.linalg.norm(summ1))}
\DoxyCodeLine{69         rho = theta*v0}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \textcolor{keywordflow}{return} rho}
\DoxyCodeLine{72 }

\end{DoxyCode}
\mbox{\Hypertarget{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}\label{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}} 
\index{Errors@{Errors}!errors@{errors}}
\index{errors@{errors}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{errors()}{errors()}}
{\footnotesize\ttfamily def Errors.\+errors (\begin{DoxyParamCaption}\item[{}]{data }\end{DoxyParamCaption})}



Computes the errors needed by the inverse kinematics algorithms. 

Specifically it calculates the misaligned vector between the goal frame and e.\+e. frame, the error due to the position of the two frames and also the error due to velocity of the two frames. 
\begin{DoxyParams}{Parameters}
{\em data} & vector coming from forward kinematics node. Constains rotation matrices, vector positions and velocities. \\
\hline
\end{DoxyParams}


Definition at line 73 of file Errors.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{73 \textcolor{keyword}{def }\mbox{\hyperlink{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}{errors}}(data):}
\DoxyCodeLine{74     \textcolor{stringliteral}{"{}"{}"{}!}}
\DoxyCodeLine{75 \textcolor{stringliteral}{    Computes the errors needed by the inverse kinematics algorithms. Specifically}}
\DoxyCodeLine{76 \textcolor{stringliteral}{    it calculates the misaligned vector between the goal frame and e.e. frame, the}}
\DoxyCodeLine{77 \textcolor{stringliteral}{    error due to the position of the two frames and also the error due to velocity}}
\DoxyCodeLine{78 \textcolor{stringliteral}{    of the two frames.}}
\DoxyCodeLine{79 \textcolor{stringliteral}{    @param data: vector coming from forward kinematics node. Constains rotation matrices,}}
\DoxyCodeLine{80 \textcolor{stringliteral}{    vector positions and velocities.}}
\DoxyCodeLine{81 \textcolor{stringliteral}{    "{}"{}"{}}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     Data = data.data}
\DoxyCodeLine{84     \textcolor{keyword}{global} Rg, Re, xg, xe, vg, ve}
\DoxyCodeLine{85 }
\DoxyCodeLine{86     \textcolor{comment}{\# Moves along Data vector.}}
\DoxyCodeLine{87     k = 0}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{90        \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{91          Rg[i][j] = Data[k+j]}
\DoxyCodeLine{92        k = k + 3  }
\DoxyCodeLine{93 }
\DoxyCodeLine{94 }
\DoxyCodeLine{95     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{96        \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{97           Re[i][j] = Data[k+j]}
\DoxyCodeLine{98        k = k + 3}
\DoxyCodeLine{99 }
\DoxyCodeLine{100     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{101        xg[i][0] = Data[k+i]}
\DoxyCodeLine{102 }
\DoxyCodeLine{103     k = k + 3}
\DoxyCodeLine{104 }
\DoxyCodeLine{105     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{106        xe[i][0] = Data[k+i]}
\DoxyCodeLine{107 }
\DoxyCodeLine{108     k = k + 3}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{111        vg[i][0] = Data[k+i]}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     k = k + 3}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(3):}
\DoxyCodeLine{116        ve[i][0] = Data[k+i] }
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{comment}{\# angular misalignment}}
\DoxyCodeLine{119     rho = \mbox{\hyperlink{namespaceErrors_a7f71b26e98bdf8ea46cc8a836554915b}{ang\_mis}}(Rg, Re)  }
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{comment}{\# position error}}
\DoxyCodeLine{122     eta = xg -\/ xe}
\DoxyCodeLine{123 }
\DoxyCodeLine{124     \textcolor{comment}{\# velocity error}}
\DoxyCodeLine{125     ni = vg -\/ ve}
\DoxyCodeLine{126 }
\DoxyCodeLine{127     }
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{comment}{\# Send rho, eta, ni}}
\DoxyCodeLine{132     err = np.array([rho[0], rho[1], rho[2], eta[0], eta[1], eta[2], ni[0], ni[1], ni[2]], dtype=np.float\_)}
\DoxyCodeLine{133     errors = util.init\_float64\_multiarray(9, 1)}
\DoxyCodeLine{134     errors.data = err}
\DoxyCodeLine{135     pub.publish(errors)}
\DoxyCodeLine{136 }
\DoxyCodeLine{137     }

\end{DoxyCode}
\mbox{\Hypertarget{namespaceErrors_a6c943ecf9e79fec7d2edc67cf759e9af}\label{namespaceErrors_a6c943ecf9e79fec7d2edc67cf759e9af}} 
\index{Errors@{Errors}!errors\_node@{errors\_node}}
\index{errors\_node@{errors\_node}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{errors\_node()}{errors\_node()}}
{\footnotesize\ttfamily def Errors.\+errors\+\_\+node (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 138 of file Errors.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{138 \textcolor{keyword}{def }\mbox{\hyperlink{namespaceErrors_a6c943ecf9e79fec7d2edc67cf759e9af}{errors\_node}}():}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     }
\DoxyCodeLine{144 }
\DoxyCodeLine{145     \textcolor{comment}{\# In ROS, nodes are uniquely named. If two nodes with the same}}
\DoxyCodeLine{146     \textcolor{comment}{\# name are launched, the previous one is kicked off. The}}
\DoxyCodeLine{147     \textcolor{comment}{\# anonymous=True flag means that rospy will choose a unique}}
\DoxyCodeLine{148     \textcolor{comment}{\# name for our 'listener' node so that multiple listeners can}}
\DoxyCodeLine{149     \textcolor{comment}{\# run simultaneously.}}
\DoxyCodeLine{150     rospy.init\_node(\textcolor{stringliteral}{'errors\_node'}, anonymous=\textcolor{keyword}{True})}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{comment}{\# errors is the callback functions}}
\DoxyCodeLine{153     rospy.Subscriber(\textcolor{stringliteral}{"{}Data\_for\_errors"{}}, Float64MultiArray, errors)}
\DoxyCodeLine{154 }
\DoxyCodeLine{155     \textcolor{comment}{\# spin() simply keeps python from exiting until this node is stopped}}
\DoxyCodeLine{156     rospy.spin()  }
\DoxyCodeLine{157 }
\DoxyCodeLine{158 }

\end{DoxyCode}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespaceErrors_a0d9c70e857a30fb1cd960b97e3e8a229}\label{namespaceErrors_a0d9c70e857a30fb1cd960b97e3e8a229}} 
\index{Errors@{Errors}!pub@{pub}}
\index{pub@{pub}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{pub}{pub}}
{\footnotesize\ttfamily Errors.\+pub = rospy.\+Publisher(\textquotesingle{}\mbox{\hyperlink{namespaceErrors_a74d369a1fac64e8a873da2dccf29b610}{errors}}\textquotesingle{}, Float64\+Multi\+Array, queue\+\_\+size=10)}



Definition at line 9 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_aa04a1cb38d02a2489c3216d0888ad17c}\label{namespaceErrors_aa04a1cb38d02a2489c3216d0888ad17c}} 
\index{Errors@{Errors}!Re@{Re}}
\index{Re@{Re}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{Re}{Re}}
{\footnotesize\ttfamily Errors.\+Re = np.\+zeros((3,3))}



Definition at line 13 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_a023b701c62a5148c5404d9551205c56d}\label{namespaceErrors_a023b701c62a5148c5404d9551205c56d}} 
\index{Errors@{Errors}!Rg@{Rg}}
\index{Rg@{Rg}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{Rg}{Rg}}
{\footnotesize\ttfamily Errors.\+Rg = np.\+zeros((3,3))}



Definition at line 12 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_a073280aada8fd1740c55bd2dcbf7a2ca}\label{namespaceErrors_a073280aada8fd1740c55bd2dcbf7a2ca}} 
\index{Errors@{Errors}!ve@{ve}}
\index{ve@{ve}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{ve}{ve}}
{\footnotesize\ttfamily Errors.\+ve = np.\+zeros((3,1))}



Definition at line 20 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_a15d70e1c6625465d323cab0f7be6c012}\label{namespaceErrors_a15d70e1c6625465d323cab0f7be6c012}} 
\index{Errors@{Errors}!vg@{vg}}
\index{vg@{vg}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{vg}{vg}}
{\footnotesize\ttfamily Errors.\+vg = np.\+zeros((3,1))}



Definition at line 19 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_a69195579482cb38bc0acf33580ce5718}\label{namespaceErrors_a69195579482cb38bc0acf33580ce5718}} 
\index{Errors@{Errors}!xe@{xe}}
\index{xe@{xe}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{xe}{xe}}
{\footnotesize\ttfamily Errors.\+xe = np.\+zeros((3,1))}



Definition at line 17 of file Errors.\+py.

\mbox{\Hypertarget{namespaceErrors_a207e0aed7e68aa47d2e8962d266d79ae}\label{namespaceErrors_a207e0aed7e68aa47d2e8962d266d79ae}} 
\index{Errors@{Errors}!xg@{xg}}
\index{xg@{xg}!Errors@{Errors}}
\doxysubsubsection{\texorpdfstring{xg}{xg}}
{\footnotesize\ttfamily Errors.\+xg = np.\+zeros((3,1))}



Definition at line 16 of file Errors.\+py.

